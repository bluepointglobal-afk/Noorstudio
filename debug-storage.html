<!DOCTYPE html>
<html>
<head>
    <title>NoorStudio Storage Debug</title>
    <style>
        body { font-family: monospace; padding: 20px; }
        .section { margin: 20px 0; padding: 15px; background: #f5f5f5; }
        h2 { margin-top: 0; }
        pre { background: white; padding: 10px; overflow-x: auto; }
        .character { border-left: 3px solid #4CAF50; padding-left: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>NoorStudio Storage Debugger</h1>

    <div class="section">
        <h2>Characters in localStorage</h2>
        <div id="characters-output"></div>
    </div>

    <div class="section">
        <h2>All localStorage Keys</h2>
        <pre id="all-keys"></pre>
    </div>

    <script>
        // Check for characters
        const characterKeys = [
            'noorstudio.characters.v1',
            'noorstudio:noorstudio.characters.v1',  // Namespaced version
            'characters.v1'
        ];

        let charactersFound = false;
        let charactersData = null;

        characterKeys.forEach(key => {
            const data = localStorage.getItem(key);
            if (data) {
                charactersFound = true;
                console.log(`Found characters at key: ${key}`);
                try {
                    charactersData = JSON.parse(data);
                    const output = document.getElementById('characters-output');
                    output.innerHTML = `
                        <h3>Key: ${key}</h3>
                        <p><strong>Total characters: ${charactersData.length}</strong></p>
                        ${charactersData.map(char => `
                            <div class="character">
                                <strong>${char.name}</strong> (${char.id})<br>
                                Status: ${char.status}<br>
                                Created: ${new Date(char.createdAt).toLocaleString()}<br>
                                ${char.imageUrl ? '✅ Has image' : '❌ No image'}<br>
                                ${char.poseSheetGenerated ? '✅ Has pose sheet' : '❌ No pose sheet'}
                            </div>
                        `).join('')}
                    `;
                } catch (e) {
                    document.getElementById('characters-output').innerHTML = `
                        <p style="color: red;">Error parsing JSON for key ${key}: ${e.message}</p>
                    `;
                }
            }
        });

        if (!charactersFound) {
            document.getElementById('characters-output').innerHTML = '<p style="color: red;">❌ No characters found in localStorage!</p>';
        }

        // Show all localStorage keys
        const allKeys = Object.keys(localStorage).sort();
        document.getElementById('all-keys').textContent = allKeys.length > 0
            ? allKeys.join('\n')
            : 'No keys in localStorage';
    </script>
</body>
</html>
